{% extends 'base/base.html' %}
{% block title %}Create Event Category{% endblock title %}
{% block breadcrumb %}Create Event Category{% endblock breadcrumb %}
{% load crispy_forms_tags %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card shadow-sm border-primary">
            <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                <h5><i class="fas fa-tags me-2"></i>Create Event Category</h5>
            </div>
            <div class="card-body">
                <form method="post" enctype="multipart/form-data" id="categoryForm">
                    {% csrf_token %}

                    <!-- Name -->
                    <div class="mb-3">
                        <label for="{{ form.name.id_for_label }}" class="form-label">
                            <i class="fas fa-pencil-alt me-1"></i>Category Name
                        </label>
                        {{ form.name|as_crispy_field }}
                    </div>

                    <!-- Description -->
                    <div class="mb-3">
                        <label for="{{ form.description.id_for_label }}" class="form-label">
                            <i class="fas fa-align-left me-1"></i>Description
                        </label>
                        {{ form.description|as_crispy_field }}
                    </div>

                    <!-- Favicon Upload -->
                    <div class="mb-3">
                        <label for="{{ form.favicon.id_for_label }}" class="form-label">
                            <i class="fas fa-image me-1"></i>Category Favicon
                        </label>
                        {{ form.favicon|as_crispy_field }}
                        <div class="mt-2">
                            <img id="faviconPreview" src="#" alt="Favicon Preview" 
                                 style="display:none; width:50px; height:50px; border-radius:5px; border:1px solid #ccc;">
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <button class="btn btn-success mt-3 w-100" type="submit">
                        <i class="fas fa-plus-circle me-1"></i>Create Category
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- JavaScript for live favicon preview -->
<script>
    document.getElementById("id_favicon").addEventListener("change", function(event){
        const input = event.target;
        const preview = document.getElementById("faviconPreview");
        if(input.files && input.files[0]){
            const reader = new FileReader();
            reader.onload = function(e){
                preview.src = e.target.result;
                preview.style.display = 'inline-block';
            }
            reader.readAsDataURL(input.files[0]);
        } else {
            preview.src = '#';
            preview.style.display = 'none';
        }
    });
</script>
{% endblock content %}
